name: Test-Docker

# allow only one "Release" workflow to run at a time
concurrency: production

on:
  push:
    branches: [update-docker-release-action]

jobs:
  publish-docker:
    runs-on: ubuntu-20.04
    steps:
      # because the docker publish action is an action we made, we have to
      # check out the repo
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Run Ganache's docker publish action
        # we are running our local action, so point directly to a folder
        # containing an `action.yml` file
        uses: ./.github/actions/docker-publish
        with:
          VERSION: 7.6.0
          TAG: latest
          DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
          DOCKER_ACCESS_TOKEN: ${{ secrets.DOCKER_ACCESS_TOKEN }}
          INFURA_KEY: ${{ secrets.INFURA_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
